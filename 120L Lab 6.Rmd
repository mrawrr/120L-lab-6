---
title: "120L Lab 6"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(afex)
library(emmeans)
library(psych)
library(tidyverse)
library(dplyr)
```


Import Data using `read.csv()`

```{r}
lab6 <- read.csv("lab6_data.csv")
```

Practice running independent samples t-test

```{r}
dep_pet <- t.test(dep ~ pet, data = lab6)
```

Results from Welch Two Sample T-Test on the effects of having pets on depression is significant (p < 0.05)
(t(129.682) = 3.74)
Mpets(from the 0 value in estimate) v Mnopets(from the 1 value in estimate)



Use `mutate()` to create a new column with recoded variables
Recode variables using `recode()`

## Where can we use this in our experiment?

```{r}
lab6 <- lab6 %>% 
  mutate(moodcond = recode(moodcond,
                  `0` = "Negative",
                  `1` = "Positive",
                  .default = NA_character_))

lab6 <- lab6 %>% 
  mutate(filmtype = recode(filmtype,
                           `0` = "Disgust",
                           `1` = "Fear",
                           .default = NA_character_))

```


Group_by() categorical variables
give back a summary of how many there are summarize

```{r}
lab6_summary <- lab6 %>% # Save as new data frame
  group_by(moodcond, filmtype) %>% 
  summarise(mean_cl_normal(anx))

lab6_summary
```

Create Graph

```{r}
lab6_graph <- ggplot(lab6_summary, 
                     aes(x = moodcond, 
                         y = y,
                         ymin = ymin, # Lower end of bar = lower CI bound
                         ymax = ymax, # Upper end of bar = upper CI bound
                         color = filmtype)) + # Different colors by film type
  geom_pointrange(position = position_dodge(width = .25)) + # Shift sideways to avoid overlap
  labs(title = "Effect of mood and film type on anxiety scores", 
       x = "Mood", 
       y = "Anxiety",
       color = "Film type") + 
  coord_cartesian(ylim = c(1,5)) # Set upper and lower bounds of graph


lab6_graph
```








